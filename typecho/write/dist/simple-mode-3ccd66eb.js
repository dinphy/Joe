function simpleMode(t){ensureState(t,"start");var n,e={},a=t.languageData||{},r=!1;for(n in t)if(n!=a&&t.hasOwnProperty(n))for(var i=e[n]=[],o=t[n],s=0;s<o.length;s++){var u=o[s];i.push(new Rule(u,t)),(u.indent||u.dedent)&&(r=!0)}return{startState:function(){return{state:"start",pending:null,indent:r?[]:null}},copyState:function(t){var n={state:t.state,pending:t.pending,indent:t.indent&&t.indent.slice(0)};return t.stack&&(n.stack=t.stack.slice(0)),n},token:tokenFunction(e),indent:indentFunction(e,a),languageData:a}}function ensureState(t,n){if(!t.hasOwnProperty(n))throw new Error("Undefined state "+n+" in simple mode")}function toRegex(t,n){if(!t)return/(?:)/;var e="";return t=t instanceof RegExp?(t.ignoreCase&&(e="i"),t.source):String(t),new RegExp((!1===n?"":"^")+"(?:"+t+")",e)}function asToken(t){if(!t)return null;if(t.apply)return t;if("string"==typeof t)return t.replace(/\./g," ");for(var n=[],e=0;e<t.length;e++)n.push(t[e]&&t[e].replace(/\./g," "));return n}function Rule(t,n){(t.next||t.push)&&ensureState(n,t.next||t.push),this.regex=toRegex(t.regex),this.token=asToken(t.token),this.data=t}function tokenFunction(d){return function(t,n){if(n.pending){var e=n.pending.shift();return 0==n.pending.length&&(n.pending=null),t.pos+=e.text.length,e.token}for(var a=d[n.state],r=0;r<a.length;r++){var i=a[r],o=(!i.data.sol||t.sol())&&t.match(i.regex);if(o){i.data.next?n.state=i.data.next:i.data.push?((n.stack||(n.stack=[])).push(n.state),n.state=i.data.push):i.data.pop&&n.stack&&n.stack.length&&(n.state=n.stack.pop()),i.data.indent&&n.indent.push(t.indentation()+t.indentUnit),i.data.dedent&&n.indent.pop();var s=i.token;if(s&&s.apply&&(s=s(o)),2<o.length&&i.token&&"string"!=typeof i.token){n.pending=[];for(var u=2;u<o.length;u++)o[u]&&n.pending.push({text:o[u],token:i.token[u-1]});return t.backUp(o[0].length-(o[1]?o[1].length:0)),s[0]}return s&&s.join?s[0]:s}}return t.next(),null}}function indentFunction(s,u){return function(t,n){if(null==t.indent||u.dontIndentStates&&-1<u.doneIndentState.indexOf(t.state))return null;var e=t.indent.length-1,a=s[t.state];t:for(;;){for(var r=0;r<a.length;r++){var i=a[r];if(i.data.dedent&&!1!==i.data.dedentIfLineStart){var o=i.regex.exec(n);if(o&&o[0]){e--,(i.next||i.push)&&(a=s[i.next||i.push]),n=n.slice(o[0].length);continue t}}}break}return e<0?0:t.indent[e]}}export{simpleMode as s};
